#!/usr/bin/env bash
set -euo pipefail

# Create a null sink for combining mic + speakers
pactl load-module module-null-sink sink_name=both sink_properties=device.description=mic-and-speakers

# Loopback: speakers (monitor) -> both
pactl load-module module-loopback \
  source=alsa_output.pci-0000_00_1f.3.analog-stereo.monitor \
  sink=both \
  latency_msec=100 adjust_time=1

# Loopback: default mic -> both
pactl load-module module-loopback \
  sink=both \
  latency_msec=100 adjust_time=1

echo "âœ… Virtual sink 'both' for 'mic-and-speaker' is ready."
